(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-live-info-live-infoplay"],{"4f68":function(t,e,i){var o=i("78cf");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("25e64cac",o,!0,{sourceMap:!1,shadowMode:!1})},"5d36":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAuklEQVRIie3VMUpDURCF4e9dbAQRkh2kCG8XsRF3kc4dpBHsJbWtZbbwKrERXETAKhtIQNJHBkYw9c3r7oEpbvP/c6c53TAMMMca97hVlx984AnfBT2+8IkZusqZJSuY/RVecl4rN//LPlnXwS15ls2F4P/zhoeSN9+PIAjmTRkBfJYmaIImaIImuJQgOnQ6AjuYx5IFvRxB8Ij36OTnLOlTVuehEjzJhVe4ix9ssYgHdimqmWAEa4HtL31bLu9Bm51zAAAAAElFTkSuQmCC"},"78cf":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,".live-all-wrap[data-v-06d76fb6]{background-color:#f4f5f6}.video-wrap[data-v-06d76fb6]{width:750px;height:400px;background-color:#000}.rounded[data-v-06d76fb6]{margin-top:20px;width:80px;height:80px;-webkit-border-radius:40px;border-radius:40px}.messagebottom[data-v-06d76fb6]{\n\t/* align-items: flex-start; */\n\t/* padding: 0 20px;\n\tmargin: 10px 0; */-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.messagebottom2[data-v-06d76fb6]{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;flex-direction:row-reverse}.message[data-v-06d76fb6]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.user_nickname[data-v-06d76fb6]{margin-top:20px;padding:10px;font-size:30px;font-weight:700}.scroll1[data-v-06d76fb6]{width:750px\n\n\n\t/* position: fixed; */\n\t/* top: 500px; */\n\t/* bottom: 100px; */}.textmessage[data-v-06d76fb6]{margin-top:20px;padding:20px;-webkit-border-radius:8px;border-radius:8px;font-size:30px;font-weight:400;max-width:450px;background-color:#34d695;color:#fff}.inputbottom[data-v-06d76fb6]{height:130px;background-color:#fff;position:fixed;bottom:0;width:750px}.inputclass[data-v-06d76fb6]{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;height:130px;width:750px}.inputborder[data-v-06d76fb6]{position:absolute;margin-top:20px;bottom:unset;height:80px;left:20px;right:140px;background-color:#f4f5f6;-webkit-border-radius:40px;border-radius:40px}.input[data-v-06d76fb6]{position:absolute;bottom:unset;height:80px;left:20px;right:100px;line-height:2em;color:#000;font-size:30px;-webkit-border-radius:40px;border-radius:40px;padding-right:20px;padding-top:10px;padding-bottom:10px}.send[data-v-06d76fb6]{position:absolute;right:30px;color:#34d695;font-size:35px;margin-top:40px}.tiwen[data-v-06d76fb6]{font-size:25px;position:absolute;right:5px;margin-top:8px}.wen-btn-wrap[data-v-06d76fb6]{width:100px;height:50px;position:absolute;right:20px;margin-top:15px;line-height:70px;-webkit-border-radius:0 50px 50px 0;border-radius:0 50px 50px 0\n\n\t/* background-color: #F5F5F5; */}.duihao-img[data-v-06d76fb6]{width:30px;height:30px}.duihao-wrap[data-v-06d76fb6]{position:absolute;width:40px;height:40px;margin-top:8px}.wen[data-v-06d76fb6]{top:20px;margin-right:10px;margin-top:20px;background-color:#34d695;color:#fff;width:40px;height:37px;font-size:30px;text-align:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.wen2[data-v-06d76fb6]{top:60px;margin-left:10px;margin-top:60px;background-color:#34d695;color:#fff;width:40px;height:37px;font-size:30px;text-align:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.zhinan[data-v-06d76fb6]{background-color:#fff;margin-top:20px;margin-left:40px;margin-right:40px;height:80px;-webkit-border-radius:10px;border-radius:10px}.zhinantext[data-v-06d76fb6]{font-size:35px;height:80px;padding-left:20px;padding-top:20px}",""]),t.exports=e},"839f":function(t,e,i){"use strict";var o=i("4ea4");i("a15b"),i("4e82"),i("b64b"),i("d3b7"),i("25f0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("4975")),a=o(i("a2d2")),s=o(i("20ff")),r=getApp(),l=(0,n.default)(r.globalData.socket_url,{query:{},transports:["websocket","polling"],timeout:5e3}),c={data:function(){return{scrollH:0,tabIndex:0,tabBars:[{name:"讲师区"},{name:"讨论区"},{name:"问答区"}],scrollInto:"",scrollTop:"",list:[],isConnectSocket:!1,liveInfo:{liveuid:"",courseid:""},userInfo:{},isQue:!1,agoraappid:"",agoramRoomName:"",agorauid:"",phonetype:0,wechatliveurl:"",myID:""}},onUnload:function(){AgoreRTCH5.client().leave()},onReady:function(){var t=this;uni.getSystemInfo({success:function(e){t.scrollH=e.screenHeight-160}}),this.pageToBottom()},onLoad:function(t){var e=this;console.log("运行在H5"),this.phonetype=3,this.userInfo=r.globalData.userinfo,this.liveInfo.liveuid=t.liveuid,this.liveInfo.courseid=t.courseid,this.enterLive(t.liveuid,t.courseid),l.emit("conn",{uid:this.userInfo.id,roomnum:this.liveInfo.liveuid,nickname:this.userInfo.user_nickname,stream:this.liveInfo.liveuid+"_"+this.liveInfo.courseid+"_0",equipment:"uni-app",token:this.userInfo.token,avatar:this.userInfo.avatar,sign:0,usertype:this.userInfo.type}),l.on("conn",(function(t){console.log("ws 已连接 "+t),e.isConnectSocket=!0}));l.on("broadcastingListen",(function(t){var i=JSON.parse(t).msg[0];void 0!=i.content&&e.list.push(i),console.log(i),e.pageToBottom()})),this.myID=r.globalData.userinfo.id},methods:{changeXXK:function(t){return this.tabIndex=t,this.tabIndex},onChangeTab:function(t){console.log("切换当前索引"+t.detail.current),this.tabIndex=t.detail.current},decypt:function(t){for(var e="",i="1ecxXyLRB.COdrAi:q09Z62ash-QGn8VFNIlb=fM/D74WjS_EUzYuw?HmTPvkJ3otK5gp",o=0;o<t.length;o++)for(var n=t[o],a=0;a<i.length;a++){var s=i[a];n==s&&(e+=0==a?i[a]:i[a-1])}return e},agoraWechat:function(t,e,i){var o=this;setTimeout((function(){var n=AogoraWechat.Client();n.setRole("audience"),n.init(o.decypt(t),(function(){console.log("小程序初始化成功"),n.join("",e,i,(function(){console.log("加入通道成功")}),(function(t){console.log("加入通道失败")}))}),(function(t){console.log("小程序初始化失败")})),n.on("stream-added",(function(t){n.subscribe(evt.uid,(function(t){console.log("订阅视频流成功playUrl"+t),o.wechatliveurl=t}),(function(t){console.log("订阅视频流错误",t),uni.showToast({icon:"none",title:"订阅视频流错误"})}))})),n.on("stream-removed",(function(t){console.log("远端流移除")})),n.rejoin("",e,i,"",(function(){console.log("重连加入通道成功")}),(function(t){console.log("重连加入通道失败")}))}),0)},agoraH5:function(t,e){var i=this;setTimeout((function(){var o=s.default.createClient({mode:"live",codec:"vp8"});s.default.client=o,o.init(i.decypt(t)),o.setClientRole("audience"),o.join("",e,null,(function(t){console.log("H5加入通道成功")}),null),o.on("stream-added",(function(t){o.subscribe(t.stream,null)})),o.on("stream-subscribed",(function(t){var e=t.stream,i=String(e.getId());console.log("订阅成功后播放主播的流streamId："+i);var o=document.getElementById("subremoteContainer");o.id=i,document.getElementById("remoteContainer").appendChild(o),e.play(i)})),o.on("stream-removed",(function(t){var e=t.stream;String(e.getId());e.close(),console.log("远端用户取消发布流时，关闭及移除对应的流。")})),o.on("peer-leave",(function(t){var e=t.stream;String(e.getId());e.close(),console.log("远端用户离开频道时，关闭及移除对应的流。")}))}),0)},enterLive:function(t,e){var i=this,o=r.globalData;i.agorauid=o.userinfo.id,uni.request({url:o.site_url+"Live.Enter",method:"GET",data:{liveuid:t,courseid:e,lessonid:"",token:o.userinfo.token,uid:o.userinfo.id},success:function(t){console.log(t),i.agoraappid=t.data.data.info[0].sound_appid,i.agoramRoomName=t.data.data.info[0].stream,console.log("获取数据agoraappid："+i.agoraappid),console.log("获取数据agoramRoomName："+i.agoramRoomName),2==i.phonetype?(console.log("接口返回进入ios"),setTimeout((function(){i.$nextTick((function(){i.$refs.videoIos.focus({appid:i.agoraappid,mRoomName:i.agoramRoomName,uid:o.userinfo.id})}))}),0)):1==i.phonetype?(console.log("接口返回进入android"),setTimeout((function(){i.$nextTick((function(){i.$refs.videoAdnroid.clearTel(i.agoraappid+"声"+i.agoramRoomName+"网"+o.userinfo.id)}))}),0)):3==i.phonetype?(console.log("接口返回进入H5"),i.agoraH5(i.agoraappid,i.agoramRoomName)):4==i.phonetype&&i.agoraWechat(i.agoraappid,i.agoramRoomName,o.userinfo.id)}})},inputing:function(t){},submit:function(t){var e=this;if(""===this.content)return uni.showToast({title:"消息不能为空",icon:"none"});this.$refs.input1.blur(),console.log("发送消息");var i=r.globalData.userinfo,o=!0===this.isQue?"1":"0",n={msg:[{_method_:"SendMsg",action:"0",token:i.token,uid:""+i.id,user_nickname:""+i.user_nickname,avatar:""+i.avatar,liveuid:""+this.liveInfo.liveuid,content:""+this.content,equipment:"uni-app",create_time:Math.floor((new Date).getTime().toString()/1e3),msgtype:o}],retcode:"000000",retmsg:"OK"};if(1==this.isConnectSocket){l.emit("broadcast",n),this.tabIndex=1;var a=r.globalData,s=this.liveInfo.liveuid,c=this.liveInfo.courseid,u=this.sort2url({uid:this.userInfo.id,liveuid:s,courseid:c,lessonid:"0",type:"0",content:this.content,url:"",user_type:this.userInfo.type});uni.request({url:a.site_url+"Live.SetChat",method:"GET",data:{uid:this.userInfo.id,token:this.userInfo.token,liveuid:s,courseid:c,lessonid:0,type:0,content:this.content,url:"",length:0,status:o,user_type:this.userInfo.type,sign:u},success:function(t){e.content=""},fail:function(){uni.showToast({icon:"none",title:"网络错误"})}})}},question:function(t){0==this.isQue?this.isQue=!0:this.isQue=!1},sort2url:function(t){for(var e=Object.keys(t).sort(),i={},o=0;o<e.length;o++)i[e[o]]=t[e[o]];var n="";for(var s in i)n=n+s+"="+i[s]+"&";return n=n.substr(0,n.length-1),n+="&"+r.globalData.sign_key,a.default.hex_md5(n)},pageToBottom:function(){var t=this.list.length-1;if(!(t<0)){var e=this;setTimeout((function(){e.scrollInto="chat"+t}),500)}}}};e.default=c},"9cae":function(t,e,i){"use strict";var o;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"live-all-wrap"},[1==t.phonetype?[o("v-uni-view",{staticClass:"video-wrap"},[o("TestText",{ref:"videoAdnroid",staticClass:"video-wrap",attrs:{tel:"xxxxxx"}})],1)]:2==t.phonetype?[o("v-uni-view",{staticClass:"video-wrap"},[o("dc-TestComponent",{ref:"videoIos",staticClass:"video-wrap",attrs:{appid:"xxxxxx"}})],1)]:3==t.phonetype?[o("v-uni-view",{ref:"remotecontainer",attrs:{id:"remoteContainer"}},[o("v-uni-view",{staticClass:"video-wrap",attrs:{id:"subremoteContainer"}})],1)]:void 0,o("v-uni-view",{staticStyle:{width:"750px",height:"90p","flex-direction":"row","background-color":"#FFFFFF"}},t._l(t.tabBars,(function(e,i){return o("v-uni-view",{key:i,ref:"tab"+i,refInFor:!0,staticStyle:{height:"90px",width:"250px","align-items":"center"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeXXK(i)}}},[o("v-uni-text",{staticStyle:{"font-size":"30px",height:"90px",width:"100px","text-align":"center","line-height":"90px","border-bottom-width":"5px","border-style":"solid"},style:{color:t.tabIndex===i?"#3BDCA8":"#A9A5A0","border-color":t.tabIndex===i?"#3BDCA8":"#FFFFFF"}},[t._v(t._s(e.name))])],1)})),1),o("div",{staticClass:"swiper-box",staticStyle:{width:"750px","background-color":"#F4F5F6"},style:{height:t.scrollH+"px"},attrs:{current:t.tabIndex},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onChangeTab.apply(void 0,arguments)}}},[0==t.tabIndex?o("div",[o("v-uni-scroll-view",{staticClass:"scroll1",staticStyle:{position:"absolute",left:"0",top:"0",right:"0",bottom:"10rpx","background-color":"#007AFF"},style:{height:t.scrollH+"px"},attrs:{"scroll-y":"true","scroll-into-view":t.scrollInto,"scroll-with-animation":!0}},[t._l(t.list,(function(e,i){return[1==e.user_type?o("v-uni-view",{key:i+"_0",staticClass:"messagebottom",attrs:{id:"chat"+i}},[o("v-uni-image",{staticClass:"rounded",attrs:{src:e.avatar}}),o("v-uni-view",{staticClass:"message"},[o("v-uni-text",{staticClass:"user_nickname"},[t._v(t._s(e.user_nickname))]),o("v-uni-text",{staticClass:"textmessage"},[t._v(t._s(e.content))])],1)],1):t._e()]}))],2)],1):t._e(),1==t.tabIndex?o("div",[o("v-uni-scroll-view",{staticClass:"scroll1",staticStyle:{position:"absolute",left:"0",top:"0",right:"0",bottom:"10rpx"},style:{height:t.scrollH+"px"},attrs:{"scroll-y":"true","scroll-into-view":t.scrollInto,"scroll-with-animation":!0}},[t._l(t.list,(function(e,i){return[e.uid===t.myID?[o("v-uni-view",{staticClass:"messagebottom2",attrs:{id:"chat"+i}},[o("v-uni-image",{staticClass:"rounded",attrs:{src:e.avatar}}),o("v-uni-view",{staticClass:"message"},[o("v-uni-text",{staticClass:"textmessage"},[t._v(t._s(e.content))])],1),"1"==e.msgtype?o("v-uni-text",{staticClass:"wen"},[t._v("问")]):t._e()],1)]:[o("v-uni-view",{staticClass:"messagebottom",attrs:{id:"chat"+i}},[o("v-uni-image",{staticClass:"rounded",attrs:{src:e.avatar}}),o("v-uni-view",{staticClass:"message"},[o("v-uni-text",{staticClass:"user_nickname"},[t._v(t._s(e.user_nickname))]),o("v-uni-text",{staticClass:"textmessage"},[t._v(t._s(e.content))])],1),"1"==e.msgtype?o("v-uni-text",{staticClass:"wen2"},[t._v("问")]):t._e()],1)]]}))],2)],1):t._e(),2==t.tabIndex?o("div",[o("v-uni-scroll-view",{staticClass:"scroll1",staticStyle:{position:"absolute",left:"0",top:"0",right:"0",bottom:"10rpx"},style:{height:t.scrollH+100+"px"},attrs:{"scroll-y":"true","scroll-into-view":t.scrollInto,"scroll-with-animation":!0}},[t._l(t.list,(function(e,i){return[e.uid===t.myID?["1"==e.msgtype?o("v-uni-view",{staticClass:"messagebottom2",attrs:{id:"chat"+i}},[o("v-uni-image",{staticClass:"rounded",attrs:{src:e.avatar}}),o("v-uni-view",{staticClass:"message"},[o("v-uni-text",{staticClass:"textmessage"},[t._v(t._s(e.content))])],1),o("v-uni-text",{staticClass:"wen"},[t._v("问")])],1):t._e()]:["1"==e.msgtype?o("v-uni-view",{staticClass:"messagebottom",attrs:{id:"chat"+i}},[o("v-uni-image",{staticClass:"rounded",attrs:{src:e.avatar}}),o("v-uni-view",{staticClass:"message"},[o("v-uni-text",{staticClass:"user_nickname"},[t._v(t._s(e.user_nickname))]),o("v-uni-text",{staticClass:"textmessage"},[t._v(t._s(e.content))])],1),o("v-uni-text",{staticClass:"wen2"},[t._v("问")])],1):t._e()]]}))],2)],1):t._e()]),2!=t.tabIndex?[o("v-uni-view",{staticClass:"inputbottom"},[o("v-uni-view",{staticClass:"inputclass"},[o("v-uni-text",{staticClass:"send",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("发送")]),o("v-uni-view",{staticClass:"inputborder"},[o("v-uni-input",{ref:"input1",staticClass:"input",attrs:{type:"text","confirm-type":"send",placeholder:"说点什么..."},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.inputing.apply(void 0,arguments)}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),o("v-uni-view",{staticClass:"wen-btn-wrap"},[o("v-uni-view",{staticClass:"duihao-wrap",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.question.apply(void 0,arguments)}}},[1==t.isQue?o("v-uni-image",{staticClass:"duihao-img",attrs:{src:i("7e6e"),mode:"aspectFill"}}):t._e(),0==t.isQue?o("v-uni-image",{staticClass:"duihao-img",attrs:{src:i("5d36"),mode:"aspectFill"}}):t._e()],1),o("v-uni-text",{staticClass:"tiwen"},[t._v("提问")])],1)],1)],1)],1)]:t._e()],2)},a=[]},ac08:function(t,e,i){"use strict";i.r(e);var o=i("9cae"),n=i("cb30");for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("b26f");var s,r=i("f0c5"),l=Object(r["a"])(n["default"],o["b"],o["c"],!1,null,"06d76fb6",null,!1,o["a"],s);e["default"]=l.exports},b26f:function(t,e,i){"use strict";var o=i("4f68"),n=i.n(o);n.a},cb30:function(t,e,i){"use strict";i.r(e);var o=i("839f"),n=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a}}]);